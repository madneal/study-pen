from jwt import jwk_from_pem
from jwcrypto import jwe,jwk
from jwcrypto.common import json_encode

with open("public.pem", "rb") as f:
    key = jwk.JWK.from_pem(f.read())
payload = '{"user":"admin"}'
token = jwe.JWE(payload, json_encode({"alg":"RSA-OAEP","enc":"A192GCM"}))
token.add_recipient(key)
print(token.serialize())

print("=========decode==========")
jwetoken = jwe.JWE()
jwetoken.deserialize(token.serialize())
jwetoken.decrypt(key)
print(jwetoken.payload)
